---
layout: post
title: "[보안 실습] iptables를 이용한 방화벽 구성"
date: 2025-05-14
categories: [Security, Linux, Networking]
tags: [iptables, firewall, ubuntu, 실습]
---

최근 리눅스 기반의 가상 네트워크 환경에서 `iptables`를 이용한 방화벽 구성 실습을 진행했다. 이 포스트에서는 실습에 사용된 네트워크 구성, 보안 정책, iptables 스크립트 구조, 느낀 점 등을 정리한다.

## ✅ 1. 실습 환경 구성

- 내부망 (INTRA): `172.16.90.0/24`
- DMZ (DMZ): `172.16.190.0/24`
- 외부망 (WAN): NAT를 통한 인터넷 연결
- 주요 장비:
  - PC A: `172.16.90.200`
  - PC B: `172.16.90.250`
  - SSH 서버: `172.16.190.200`
  - HTTP 서버: `172.16.190.250`
  - DNS 서버: `8.8.8.8`
  - 방화벽 VM (iptables 실행): 3개의 NIC 사용

## 🔒 2. 주요 보안 정책

- 외부(EXT) → 내부(INTRA) 접근 전면 차단
- 외부 → DMZ는 HTTP(80)만 허용
- 내부 → 외부: DNS, HTTP 허용
- 내부 → SSH 서버 접근 허용
- 내부 간 ping 가능, 외부 ping 차단

## 🛠 3. iptables 스크립트 핵심

```bash
# 변수 정의
IN_IF="eth1"
DMZ_IF="eth2"
EXT_IF="eth0"
PC_A="172.16.90.200"
HTTP_SERVER="172.16.190.250"

# 정책 초기화
iptables -F
iptables -X
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# 내부 → 외부 DNS 허용
iptables -A FORWARD -s $PC_A -p udp --dport 53 -d 8.8.8.8 -j ACCEPT
